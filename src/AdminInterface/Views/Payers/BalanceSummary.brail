<script>
	$(function () {
		$("#new-payment-form").validate();
	});
</script>
<div class=block>

<form id="new-payment-form" class="accountant-friendly" method=post action="${siteroot}/Payers/${payer.Id}/NewPayment">
	<h4>Новый платеж</h4>
	<table>
		<tr>
			<th>Дата платежа</th>
			<th>Номер документа</th>
			<th>Сумма</th>
		</tr>
		<tr>
			<td>
				<input type=text name=Payment.PayedOn value=${System.DateTime.Today} class="input-date required">
				<input type="button" class="CalendarInput" />
			</td>
			<td>
				<input type=text name=Payment.DocumentNumber>
			</td>
			<td>
				<input type=text name=Payment.Sum class="input-sum required">
			</td>
			<td>
				<input type=submit value="Добавить">
			</td>
		</tr>
	</table>
</form>
</div>

<table class=DataTable>
	<% if items.Count: %>
	<thead>
		<tr>
			<th></th>
			<th>№</th>
			<th>Дата</th>
			<th>Счет</th>
			<th>Платеж</th>
			<th>Акт</th>
		</tr>
	</thead>
	<% for i, item in enumerate(items): %>
	<tr class="${ViewHelper.GetRowStyle(i)}">
		<td>
			<% if item.Id > 0: %>
				<% if item.IsPayment: %>
				<a href="${siteroot}/Payments/${item.Id}/Edit">Печать</a>
				<% end %>
				<% if item.IsInvoice: %>
				<a href="${siteroot}/Invoices/${item.Id}/Print">Печать</a>
				<a href="${siteroot}/Invoices/${item.Id}/Edit">Редактировать</a>
				<% end %>
				<% if item.IsAct: %>
				<a href="${siteroot}/Acts/${item.Id}/Print">Печать</a>
				<a href="${siteroot}/Acts/${item.Id}/Edit">Редактировать</a>
				<% end %>
			<% end %>
		</td>
		<td>
			<% if item.Id > 0: %>
				${item.Id}
			<% end %>
		</td>
		<td>${item.Date.ToShortDateString()}</td>

		<% if item.IsInvoice: %>
		<td style="text-align:right;">${item.Sum.ToString("C")}</td>
		<% else: %>
		<td></td>
		<% end %>

		<% if item.IsPayment: %>
		<td style="text-align:right;">${item.Sum.ToString("C")}</td>
		<% else: %>
		<td></td>
		<% end %>

		<% if item.IsAct: %>
		<td style="text-align:right;">${item.Sum.ToString("C")}</td>
		<% else: %>
		<td></td>
		<% end %>
	</tr>
	<% end %>
	<tr class="${ViewHelper.GetRowStyle(items.Count)}">
		<td></td>
		<td></td>
		<td></td>
		<td style="text-align:right;">${payer.Balance.ToString("C")}</td>
		<td></td>
		<td></td>
	<tr>
	<% else: %>
	<tr class=EmptyData>
		<td>По вашему запросу ничего не найдено</td>
	</tr>
	<% end %>
</table>
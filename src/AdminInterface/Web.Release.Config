<?xml version="1.0"?>
<configuration>
	<configSections>
		<section name="activerecord" type="Castle.ActiveRecord.Framework.Config.ActiveRecordSectionHandler, Castle.ActiveRecord" />
		<section name="monorail" type="Castle.MonoRail.Framework.Configuration.MonoRailSectionHandler, Castle.MonoRail.Framework" />
    <section name="brail" type="Castle.MonoRail.Views.Brail.BrailConfigurationSection, Castle.MonoRail.Views.Brail"/>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler,log4net"/>
    <sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
      <section name="AdminInterface.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
    </sectionGroup>
  </configSections>

  <log4net>

    <appender name="MyEmail" type="log4net.Appender.SmtpAppender, log4net">
      <to value="r.kvasov@analit.net" />
      <from value="service@analit.net" />
      <subject value="Ошибка в Административном интерфейсе" />
      <smtpHost value="mail.adc.analit.net" />
      <lossy value="false" />
      <bufferSize value="0" />
      <layout type="log4net.Layout.PatternLayout, log4net">
        <conversionPattern value="Version: %property{Version}%newlineHost: %property{log4net:HostName} %newlineUserName: %username %newlineDate: %date %newline %m %n" />
      </layout>
    </appender>

    <appender name="ServiceEmail" type="log4net.Appender.SmtpAppender, log4net">
      <to value="service@analit.net" />
      <from value="service@analit.net" />
      <subject value="Ошибка в Административном интерфейсе" />
      <smtpHost value="mail.adc.analit.net" />
      <lossy value="false" />
      <bufferSize value="0" />
      <layout type="log4net.Layout.PatternLayout, log4net">
        <conversionPattern value="Version: %property{Version}%newlineHost: %property{log4net:HostName} %newlineUserName: %username %newlineDate: %date %newline %m %n" />
      </layout>
    </appender>

    <appender name="LogFile" type="log4net.Appender.RollingFileAppender, log4net">
      <file value="AdminInterface.log" />
      <appendToFile value="true" />
      <rollingStyle value="Size" />
      <staticLogFileName value="true" />
      <maximumFileSize value="1MB" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%d{HH:mm:ss.fff} [%t] %-5p %c - %m%n" />
      </layout>
    </appender>

    <root>
      <level value="ERROR" />
      <appender-ref ref="LogFile" />
			<appender-ref ref="ServiceEmail" />
			<appender-ref ref="MyEmail" />
    </root>

		<logger name="AdminInterface" additivity="false">
			<level value="WARN" />
			<appender-ref ref="LogFile"/>
		</logger>

  </log4net>

  <connectionStrings>
		<add name="Main" connectionString="Data Source=sql.analit.net;Database=usersettings;User ID=AdmInterface;password=samepass;Connect Timeout=300;pooling=true;convert zero datetime=yes;"/>
	</connectionStrings>

	<monorail>
		<controllers>
			<assembly>AdminInterface</assembly>
			<assembly>Common.Web.Ui</assembly>
		</controllers>
		<components>
			<assembly>AdminInterface</assembly>
			<assembly>Common.Web.Ui</assembly>
		</components>
		<viewEngines viewPathRoot="Views">
			<add type="Castle.MonoRail.Views.Brail.BooViewEngine, Castle.MonoRail.Views.Brail" />
			<add type="Castle.MonoRail.Framework.Views.Aspx.WebFormsViewEngine, Castle.MonoRail.Framework" />
			<additionalSources>
				<assembly name="Common.Web.Ui" namespace="Common.Web.Ui.Views" />
			</additionalSources>
		</viewEngines>
	</monorail>

  <brail>
    <import namespace="Boo.Lang.Builtins" />
		<import namespace="System.Web" />
  </brail>

	<system.web>
		<httpHandlers>
			<clear />
			<add path="WebResource.axd" verb="GET" type="System.Web.Handlers.AssemblyResourceLoader" />
			<add path="App_Themes/**/*.*" verb="*" type="System.Web.StaticFileHandler" />
			<add path="css/*.*" verb="*" type="System.Web.StaticFileHandler" />
			<add path="Images/*.*" verb="*" type="System.Web.StaticFileHandler" />
			<add path="JavaScript/*.*" verb="*" type="System.Web.StaticFileHandler" />
			<add verb="*" path="*.rails" type="Castle.MonoRail.Framework.MonoRailHttpHandlerFactory, Castle.MonoRail.Framework" />
			<add verb="*" path="*.aspx" type="System.Web.UI.PageHandlerFactory" />
			<add path="*" verb="*" type="Castle.MonoRail.Framework.MonoRailHttpHandlerFactory, Castle.MonoRail.Framework" />
		</httpHandlers>
		<siteMap>
			<providers>
				<add name="SiteMapProvider" type="System.Web.XmlSiteMapProvider" siteMapFile="~/Web.sitemap" />
			</providers>
		</siteMap>
		<httpModules>
			<add name="routing" type="Castle.MonoRail.Framework.Routing.RoutingModuleEx, Castle.MonoRail.Framework" />
			<add name="active-record" type="Castle.ActiveRecord.Framework.SessionScopeWebModule, Castle.ActiveRecord" />
		</httpModules>
		<compilation debug="false" strict="false" explicit="true" />
		<customErrors mode="On" defaultRedirect="~/Rescue/error.aspx"/>
		<authentication mode="Windows"/>
		<authorization>
			<allow users="*"/>
		</authorization>
		<trace enabled="false" requestLimit="10" pageOutput="false" traceMode="SortByTime" localOnly="true"/>
		<sessionState mode="InProc" stateConnectionString="tcpip=127.0.0.1:42424" sqlConnectionString="data source=127.0.0.1;user id=sa;password=" cookieless="false" timeout="20"/>
		<globalization requestEncoding="windows-1251" responseEncoding="windows-1251"/>
		<pages>
			<namespaces>
				<add namespace="System.Data" />
				<add namespace="System.Drawing" />
			</namespaces>
			<controls>
				<add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
				<add tagPrefix="asp" namespace="System.Web.UI.WebControls" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
			</controls>
		</pages>
	</system.web>

	<activerecord isWeb="true">
		<config>
      <add key="connection.driver_class" value="NHibernate.Driver.MySqlDataDriver"/>
      <add key="dialect" value="NHibernate.Dialect.MySQLDialect"/>
      <add key="connection.provider" value="NHibernate.Connection.DriverConnectionProvider"/>
      <add key="connection.connection_string_name" value="Main"/>
      <add key="show_sql" value="true"/>
    </config>
	</activerecord>

  <applicationSettings>
    <AdminInterface.Properties.Settings>
      <setting name="RegistrationCardEmailBodyForDrugstore" serializeAs="String">
        <value>Направляем Вам регистрационную карту Аптеки с учетными данными (имя и пароль) для работы в системе АналитФармация – в приложении.

Направляем Вам материалы для самостоятельной установки (переустановки) копии программы АналитФармация (если Вы хотите сделать это самостоятельно)
Последний релиз программы доступен по адресу www.analit.net в разделе "Загрузить программу"
Вы получите саморазворачивающийся архив.
Запустите его на исполнение.  После распаковки на выбранном Вами диске появится папка AnalitFNew. Из нее запустите файл analitf.exe
Далее програма запросит вписать учетные данные (имя и пароль) - возьмите их из регистрационной карты для каждого из пользователей - в приложении.
Там же во вкладке "Соединение" настройте соединение с Интернет, если Вы соединяетесь через модем по телефонной линии, то посавьте галочку
"Устанавливать удаленное соединение" и чуть ниже выберите используемое соединение. Если работаете через Прокси-сервер, войдите в соответствующую вкладку и пропишите необходимые настройки.

Успехов в работе.  Пожалуйста, сохраните регистрационную карту

При необходимости, готовы перезвонить и дать все необходимые консультации

С уважением, Аналитическая компания "Инфорум", г. Воронеж

Москва +7 495 6628727
С.-Петербург +7 812 3090521
Воронеж +7 4732 606000
Челябинск +7 351 7298143</value>
      </setting>
      <setting name="RegistrationCardEmailBodyForSupplier" serializeAs="String">
        <value>Направляем Вам регистрационную карту Поставщика с учетными данными (имя и пароль) для доступа к управлению Вашей информацией в системе электронного заказа АналитФармация. Регистрационная карта - в приложении.

Для доступа к интерфейсу управления на www.analit.net войдите в раздел “Для зарегистрированных пользователей”, введите имя и пароль из рег.карты.
Просим Вас заполнить контактную информацию в разделе ”Контактная информация” и систематически проверять актуальность внесённых Вами данных.
В разделе "Прайс-листы" Вы можете просмотреть информацию об их обработке и настройке.
В разделе "Управление сопоставлением" работать с сопоставлением позиций Вашего прайс-листа в системе.
В разделе ”Клиенты” необходимо указать E-mail для доставки вам заказов (если доставка осуществляется по e-mail). При входе в соответствующий регион, Вы получаете список клиентов-аптек, по которым можете посмотреть информацию по обновлению данных той или иной аптеки, выставить скидки-наценки, сумму минимального заказа, определить и выбрать ценовую колонку. А также именно здесь вам необходимо прописывать ваши внутренние коды, присвоенные конкретным аптекам (если эти коды должны прописываться в направляемую Вам заявку).
В разделе ”Управление заказами” Вам доступны заказы, сделанные аптеками в Ваш адрес, которые при необходимости вы можете отправить себе повторно.

Надеемся, что работа с остальными разделами (опциями) нашей системы не составит для Вас труда

Готовы ответить на любые Ваши вопросы, как по работе в представленном выше интерфейсе, так и по любым аспектам нашего IT-взаимодействия.
ВНИМАНИЕ! Информацию, указанную в регистрационной карте, необходимо хранить, т.к. она является ключом доступа к интерфейсу управления настройками клиентов.
Просьба подтвердить получение.

С уважением, Аналитическая компания "Инфорум", г. Воронеж

Москва +7 495 6628727
С.-Петербург +7 812 3090521
Воронеж +7 4732 606000
Челябинск +7 351 7298143</value>
      </setting>
    </AdminInterface.Properties.Settings>    
  </applicationSettings>

  <system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="BasicHttpBinding_IStatisticService" closeTimeout="00:01:00"
            openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
            allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
            maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
            messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
            useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
              maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="TransportCredentialOnly">
            <transport clientCredentialType="Ntlm" proxyCredentialType="None" realm="" />
            <message clientCredentialType="UserName" algorithmSuite="Default" />
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <client>
			<endpoint address="http://ios.analit.net/8F24BB48/StatisticService.svc"
          binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IStatisticService"
          contract="ServiceReference2.IStatisticService" name="BasicHttpBinding_IStatisticService">
				<identity>
					<userPrincipalName value="runer@analit.net" />
				</identity>
			</endpoint>
    </client>
  </system.serviceModel>

	<system.webServer>
		<defaultDocument>
			<files>
				<add value="default.aspx" />
			</files>
		</defaultDocument>
		<modules>
			<add name="active-record" type="Castle.ActiveRecord.Framework.SessionScopeWebModule, Castle.ActiveRecord" preCondition="managedHandler" />
			<add name="routing" type="Castle.MonoRail.Framework.Routing.RoutingModuleEx, Castle.MonoRail.Framework" />
		</modules>
		<handlers>
			<clear />
			<add name="Default" path="**/" verb="*" modules="DefaultDocumentModule" resourceType="Either" requireAccess="Read" />
			<add name="WebResource" path="WebResource.axd" verb="GET" type="System.Web.Handlers.AssemblyResourceLoader" />
			<add name="Themes" path="App_Themes/**/*.*" verb="*" type="System.Web.StaticFileHandler" />
			<add name="Css" path="css/*.*" verb="*" type="System.Web.StaticFileHandler" />
			<add name="Images" path="Images/*.*" verb="*" type="System.Web.StaticFileHandler" />
			<add name="JavaScript" path="JavaScript/*.*" verb="*" type="System.Web.StaticFileHandler" />
			<add name="Rails" verb="*" path="*.rails" type="Castle.MonoRail.Framework.MonoRailHttpHandlerFactory, Castle.MonoRail.Framework" />
			<add name="Aspx" verb="*" path="*.aspx" type="System.Web.UI.PageHandlerFactory" />
			<add name="Route" path="*" verb="*" type="Castle.MonoRail.Framework.MonoRailHttpHandlerFactory, Castle.MonoRail.Framework" />

		</handlers>
		<validation validateIntegratedModeConfiguration="false" />
	</system.webServer>

</configuration>
